#!/usr/bin/env bash

# Check if TERRAFORM_CLOUD_TOKEN is set
#if [ -z "$TERRAFORM_CLOUD_TOKEN"]; THEN
#    echo "ERROR: TERRAFORM_CLOUD_TOKEN environment variable is not set."
#    exit 1
#fi

# Generate credentials.tfrc.json with the token
cat > /home/gitpod/.terraform.d/credentials.tfrc.json << EOF
{
    "credentials": {
        "app.terraform.io": {
            "token": "$TERRAFORM_CLOUD_TOKEN"
        }
    }
}
EOF

echo "credentials.tfrc.json has been generated."